<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Bootstrap demo</title>
</head>
<body>


    

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
<link rel="stylesheet" href="stylesheet.css">


<div class="main">
    <iframe name="dummyframe" id="dummyframe" style="display: none;"></iframe>
    <div class="row justify-content-around align-items-center">
      <div id="register" class="col-5">
          <form action="" method="post" id="registerform" class="form-centered">
              <input placeholder="email" type="email" name="email" id="email">
              <input placeholder="name" type="text" name="name" id="name">
              <input placeholder="password" type="password" name="password" id="password">
              <!-- super token -->
              <input disabled class="submit-button" id="submit" type="submit" value="REGISTER">
          </form>
      </div>
      <h1 class="col-2 d-inline text-center align-middle">OR</h1>
      <div id="login" class="col-5">
          <form action="http://127.0.0.1:5000/auth/login" method="post" target="dummyframe" id="loginform" class="form-centered">
              <input placeholder="email" type="text" name="email" id="email">
              <input placeholder="password" type="password" name="password" id="password">
              <input class="submit-button" id="submit" type="submit" value="LOGIN">
          </form>
      </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>

<script>
    const API_URL = 'http://127.0.0.1:5000'    

    function handle_login_js(json){
        localStorage.setItem('comexp-token', JSON.stringify(json['token']));
    }

    document.forms['loginform'].addEventListener('submit', (event) => {
        event.preventDefault();
        fetch(event.target.action, {
            method: 'POST',
            body: new URLSearchParams(new FormData(event.target)), // event.target is the form
        }).then((response) => {
            if (!response.ok) {
            throw new Error(`HTTP error! Status: ${response.status}`);
            }
            return response.json(); // or response.text() or whatever the server sends
        }).then((json) => {
            handle_login_js(json);
        }).catch((error) => {
            console.log(error);
        });
    });

   </script>

</body>
</html>